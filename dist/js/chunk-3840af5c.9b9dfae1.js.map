{"version":3,"sources":["webpack:///./src/views/sucai.vue?7bef","webpack:///src/views/sucai.vue","webpack:///./src/views/sucai.vue?41c4","webpack:///./src/views/sucai.vue","webpack:///./src/views/sucai.vue?2654"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","on","$event","changeCollect","model","value","reqParams","callback","$$v","$set","expression","staticStyle","dialogVisible","_l","item","key","id","url","collect","style","color","is_collected","collected","delCollect","_e","images","length","per_page","count","page","changePage","headers","handleAvatarSuccess","imageUrl","staticRenderFns","name","data","created","getData","methods","res","$message","success","setTimeout","newPage","$confirm","confirmButtonText","cancelButtonText","type","component"],"mappings":"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","file":"js/chunk-3840af5c.9b9dfae1.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sucai-container\"},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('my-bread',[_vm._v(\"素材管理\")])],1),_c('div',[_c('el-radio-group',{attrs:{\"size\":\"small\"},on:{\"change\":function($event){return _vm.changeCollect()}},model:{value:(_vm.reqParams.collect),callback:function ($$v) {_vm.$set(_vm.reqParams, \"collect\", $$v)},expression:\"reqParams.collect\"}},[_c('el-radio-button',{attrs:{\"label\":false}},[_vm._v(\"全部\")]),_c('el-radio-button',{attrs:{\"label\":true}},[_vm._v(\"收藏\")])],1),_c('el-button',{staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"success\",\"size\":\"small\"},on:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"添加素材\")])],1),_c('div',[_vm._l((_vm.images),function(item){return _c('div',{key:item.id,staticClass:\"img\"},[_c('img',{attrs:{\"src\":item.url,\"alt\":\"\"}}),(_vm.reqParams.collect === false)?_c('div',{staticClass:\"icon\"},[_c('span',{staticClass:\"el-icon-star-off\",style:({ color: item.is_collected ? 'red' : '#fff' }),on:{\"click\":function($event){return _vm.collected(item.id, item.is_collected)}}}),_c('span',{staticClass:\"el-icon-delete\",on:{\"click\":function($event){return _vm.delCollect(item.id)}}})]):_vm._e()])}),(_vm.images.length === 0)?_c('div',{staticClass:\"div\"},[_vm._v(\"暂无数据\")]):_vm._e()],2),_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next\",\"page-size\":_vm.reqParams.per_page,\"total\":_vm.count,\"current-page\":_vm.reqParams.page},on:{\"current-change\":_vm.changePage}})],1),_c('el-dialog',{attrs:{\"title\":\"添加素材\",\"visible\":_vm.dialogVisible,\"width\":\"300px\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\",\"name\":\"image\",\"headers\":_vm.headers,\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess}},[(_vm.imageUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"sucai-container\">\r\n    <!-- 卡片区域 -->\r\n    <el-card class=\"box-card\">\r\n      <!-- 卡片头部 -->\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <!-- 面包屑组件 -->\r\n        <my-bread>素材管理</my-bread>\r\n      </div>\r\n\r\n      <!-- 卡片内容 -->\r\n      <div>\r\n        <el-radio-group\r\n          @change=\"changeCollect()\"\r\n          v-model=\"reqParams.collect\"\r\n          size=\"small\"\r\n        >\r\n          <el-radio-button :label=\"false\">全部</el-radio-button>\r\n          <el-radio-button :label=\"true\">收藏</el-radio-button>\r\n        </el-radio-group>\r\n        <el-button\r\n          @click=\"dialogVisible = true\"\r\n          type=\"success\"\r\n          size=\"small\"\r\n          style=\"float:right\"\r\n          >添加素材</el-button\r\n        >\r\n      </div>\r\n      <!-- 图片区域 -->\r\n      <div>\r\n        <div class=\"img\" v-for=\"item in images\" :key=\"item.id\">\r\n          <img :src=\"item.url\" alt />\r\n          <div class=\"icon\" v-if=\"reqParams.collect === false\">\r\n            <span\r\n              class=\"el-icon-star-off\"\r\n              :style=\"{ color: item.is_collected ? 'red' : '#fff' }\"\r\n              @click=\"collected(item.id, item.is_collected)\"\r\n            ></span>\r\n            <span class=\"el-icon-delete\" @click=\"delCollect(item.id)\"></span>\r\n          </div>\r\n        </div>\r\n        <div class=\"div\" v-if=\"images.length === 0\">暂无数据</div>\r\n      </div>\r\n\r\n      <!-- 分页 -->\r\n      <el-pagination\r\n        background\r\n        layout=\"prev, pager, next\"\r\n        :page-size=\"reqParams.per_page\"\r\n        :total=\"count\"\r\n        :current-page=\"reqParams.page\"\r\n        @current-change=\"changePage\"\r\n      ></el-pagination>\r\n    </el-card>\r\n\r\n    <!-- 添加素材 -->\r\n    <el-dialog title=\"添加素材\" :visible.sync=\"dialogVisible\" width=\"300px\">\r\n      <el-upload\r\n        class=\"avatar-uploader\"\r\n        action=\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\"\r\n        name=\"image\"\r\n        :headers=\"headers\"\r\n        :show-file-list=\"false\"\r\n        :on-success=\"handleAvatarSuccess\"\r\n      >\r\n        <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\" />\r\n        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n      </el-upload>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport auth from \"@/utils/data\";\r\nexport default {\r\n  name: \"sucai\",\r\n  data() {\r\n    return {\r\n      reqParams: {\r\n        collect: false,\r\n        page: 1,\r\n        per_page: 10\r\n      },\r\n      count: 0,\r\n      images: [],\r\n      dialogVisible: false,\r\n      //上传成功后的图片地址\r\n      imageUrl: \"\",\r\n      headers: { Authorization: `Bearer ${auth.getUser().token}` }\r\n    };\r\n  },\r\n  created() {\r\n    this.getData();\r\n  },\r\n  methods: {\r\n    // openAddDialog() {\r\n    //   this.dialogVisible = true\r\n    // },\r\n    handleAvatarSuccess(res) {\r\n      this.imageUrl = res.data.url;\r\n      this.$message.success(\"上传图片成功\");\r\n      setTimeout(() => {\r\n        this.dialogVisible = false;\r\n        this.getData();\r\n        this.reqParams.page = 1;\r\n        this.imageUrl = null;\r\n      }, 2000);\r\n    },\r\n    //获取素材列表\r\n    async getData() {\r\n      const {\r\n        data: { data }\r\n      } = await this.$http.get(\"user/images\", { params: this.reqParams });\r\n      this.count = data.total_count;\r\n      this.images = data.results;\r\n    },\r\n    changePage(newPage) {\r\n      this.reqParams.page = newPage;\r\n      this.getData();\r\n    },\r\n    async collected(id, status) {\r\n      try {\r\n        const {\r\n          data: { data }\r\n        } = await this.$http.put(`user/images/${id}`, {\r\n          collect: !status\r\n        });\r\n        //data中的collect是修改后的图片状态\r\n        this.$message.success(data.collect ? \"收藏成功\" : \"取消收藏成功\");\r\n        //视图: 收藏按钮颜色样式,数据驱动视图\r\n        this.getData();\r\n        // item.is_collected = data.collect\r\n      } catch (e) {\r\n        this.$message.error(\"操作失败\");\r\n      }\r\n    },\r\n    delCollect(id) {\r\n      this.$confirm(\"此操作将永久删除该文件, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      })\r\n        .then(async () => {\r\n          try {\r\n            await this.$http.delete(`user/images/${id}`);\r\n            this.$message.success(\"删除成功!\");\r\n            this.getData();\r\n          } catch (e) {\r\n            this.$message.error(\"删除失败!\");\r\n          }\r\n        })\r\n        .catch(() => {});\r\n    },\r\n    changeCollect() {\r\n      this.reqParams.page = 1;\r\n      this.getData();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.img {\r\n  display: inline-block;\r\n  position: relative;\r\n  width: 180px;\r\n  height: 180px;\r\n  margin: 20px 50px 20px 0;\r\n  img {\r\n    width: 100%;\r\n    height: 100%;\r\n    border: 1px dashed #ccc;\r\n  }\r\n  .icon {\r\n    position: absolute;\r\n    left: 0;\r\n    bottom: 0;\r\n    background: rgba(0, 0, 0, 0.3);\r\n    width: 100%;\r\n    height: 30px;\r\n    line-height: 30px;\r\n    text-align: center;\r\n    color: aliceblue;\r\n    span {\r\n      margin: 0 30px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sucai.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sucai.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./sucai.vue?vue&type=template&id=7e4053bf&scoped=true&\"\nimport script from \"./sucai.vue?vue&type=script&lang=js&\"\nexport * from \"./sucai.vue?vue&type=script&lang=js&\"\nimport style0 from \"./sucai.vue?vue&type=style&index=0&id=7e4053bf&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7e4053bf\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sucai.vue?vue&type=style&index=0&id=7e4053bf&scoped=true&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sucai.vue?vue&type=style&index=0&id=7e4053bf&scoped=true&lang=less&\""],"sourceRoot":""}