(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3840af5c"],{"1be1":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sucai-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("my-bread",[e._v("素材管理")])],1),a("div",[a("el-radio-group",{attrs:{size:"small"},on:{change:function(t){return e.changeCollect()}},model:{value:e.reqParams.collect,callback:function(t){e.$set(e.reqParams,"collect",t)},expression:"reqParams.collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"small"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加素材")])],1),a("div",[e._l(e.images,(function(t){return a("div",{key:t.id,staticClass:"img"},[a("img",{attrs:{src:t.url,alt:""}}),!1===e.reqParams.collect?a("div",{staticClass:"icon"},[a("span",{staticClass:"el-icon-star-off",style:{color:t.is_collected?"red":"#fff"},on:{click:function(a){return e.collected(t.id,t.is_collected)}}}),a("span",{staticClass:"el-icon-delete",on:{click:function(a){return e.delCollect(t.id)}}})]):e._e()])})),0===e.images.length?a("div",{staticClass:"div"},[e._v("暂无数据")]):e._e()],2),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":e.reqParams.per_page,total:e.count,"current-page":e.reqParams.page},on:{"current-change":e.changePage}})],1),a("el-dialog",{attrs:{title:"添加素材",visible:e.dialogVisible,width:"300px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",name:"image",headers:e.headers,"show-file-list":!1,"on-success":e.handleAvatarSuccess}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)},r=[],c=(a("96cf"),a("1da1")),n=a("25a9"),i={name:"sucai",data:function(){return{reqParams:{collect:!1,page:1,per_page:10},count:0,images:[],dialogVisible:!1,imageUrl:"",headers:{Authorization:"Bearer ".concat(n["a"].getUser().token)}}},created:function(){this.getData()},methods:{handleAvatarSuccess:function(e){var t=this;this.imageUrl=e.data.url,this.$message.success("上传图片成功"),setTimeout((function(){t.dialogVisible=!1,t.getData(),t.reqParams.page=1,t.imageUrl=null}),2e3)},getData:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("user/images",{params:e.reqParams});case 2:a=t.sent,s=a.data.data,e.count=s.total_count,e.images=s.results;case 6:case"end":return t.stop()}}),t)})))()},changePage:function(e){this.reqParams.page=e,this.getData()},collected:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,a.$http.put("user/images/".concat(e),{collect:!t});case 3:r=s.sent,c=r.data.data,a.$message.success(c.collect?"收藏成功":"取消收藏成功"),a.getData(),s.next=12;break;case 9:s.prev=9,s.t0=s["catch"](0),a.$message.error("操作失败");case 12:case"end":return s.stop()}}),s,null,[[0,9]])})))()},delCollect:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(c["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.delete("user/images/".concat(e));case 3:t.$message.success("删除成功!"),t.getData(),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$message.error("删除失败!");case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))).catch((function(){}))},changeCollect:function(){this.reqParams.page=1,this.getData()}}},l=i,o=(a("c3e3"),a("2877")),u=Object(o["a"])(l,s,r,!1,null,"7e4053bf",null);t["default"]=u.exports},"4eeb":function(e,t,a){},c3e3:function(e,t,a){"use strict";var s=a("4eeb"),r=a.n(s);r.a}}]);
//# sourceMappingURL=chunk-3840af5c.9b9dfae1.js.map